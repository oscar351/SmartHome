<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>아이디 / 비밀번호 찾기</title>
<link rel='stylesheet' href='/stylesheets/findUser.css' />
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
</head>
<body>
    <fieldset id="join-form">
        <h1>MOBLE<br>Sweet Home</h1>
        <form action="/findid" method="post">
          <label class="legend"><strong>아이디 찾기</strong></label>
          <div>
          <label class="legend"><strong>이메일</strong></label>
          <input type="text" class="text" id="id" name="findemail" maxlength="20" required>
          <input name="go" type="submit" id="findID" class="go" value="검색">
        </div>
        </form>
        <form action="/new_password" method="post">
          <label class="legend"><strong>비밀번호 찾기</strong></label>
        <div id="find_password">
        <label class="legend"><strong>아이디</strong></label>
        <input type="text" id="findID_id" class="text" name="findID" required>
        <label class="legend"><strong>이름</strong></label>
        <input type="text" id="findID_name" class="text" name="findname" required>
        <input name="go" type="submit" id="findpassword" class="go" value="검색">
        </div>
        <div id="new_password">
          <label class="legend"><strong>새로운 비밀번호</strong></label>
          <input type="password" class="text" id="new_password1" name="new_password1" required>
          <label class="legend"><strong>새로운 비밀번호 확인</strong></label>
          <input type="password" class="text" id="new_password2" name="new_password2" required>
          <p id="checkedpw">* 비밀번호가 일치합니다.</p>
          <p id="notcheckpw">* 비밀번호가 일치하지 않습니다.</p>
          <input id="new_password_submit" type="submit" class="go" value="확인">
          </div>
        </form>
          <script type="text/javascript">
            $("#new_password").hide();
            $("#checkedpw").hide();
            $("#notcheckpw").hide();
            $('#findpassword').click(function(){
              let userid = $('#findID_id').val();
              let username = $('#findID_name').val();
              $.ajax({
                  url : "findpw",
                  type : "post",
                  data : {
                    userID: userid,
                    userNAME : username
                  },
                  dataType : 'json',
                  success : function(result){
                      if(result == 0){
                          alert('일치하는 회원 정보가 없습니다.');
                      }else{
                        alert('새로운 비밀번호를 입력해주세요!');
                        $("#new_password").show();
                        $("#find_password").hide();
                      }
                  },
                  error : function(){
                      alert("서버요청실패");
                  }
              });
            });

            $("#new_password2").keyup(function(){
                var pwd1 = $("#new_password1").val();
                var pwd2 = $("#new_password2").val();
                if(pwd1 != "" || pwd2 != ""){
                    if(pwd1 == pwd2) {
                        $("#checkedpw").show();
                        $("#notcheckpw").hide();
                        $("#new_password_submit").removeAttr("disabled");
                    }else{
                        $("#checkedpw").hide();
                        $("#notcheckpw").show();
                        $("#new_password_submit").attr("disabled", "disabled");
                    }
                }
            });
          </script>
        <form action="/" method="get">
        <input type="submit" class="gohome" value="홈">
        </form>
    </fieldset>
</body>
</html>
